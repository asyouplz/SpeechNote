%%{init: {'theme':'base'}}%%

graph TB
    subgraph "Error Sources"
        USER[User Input Errors]
        FILE[File System Errors]
        NET[Network Errors]
        API[API Errors]
        SYS[System Errors]
    end
    
    subgraph "Error Detection Layer"
        VALIDATE[Input Validation]
        MONITOR[Health Monitoring]
        TIMEOUT[Timeout Detection]
        CHECK[Status Checking]
    end
    
    subgraph "Error Classification"
        RECOVERABLE[Recoverable Errors]
        RETRYABLE[Retryable Errors]
        FATAL[Fatal Errors]
        BUSINESS[Business Logic Errors]
    end
    
    subgraph "Error Handling Strategies"
        RETRY_STRATEGY[Retry with Backoff]
        FALLBACK[Fallback to Cache]
        GRACEFUL[Graceful Degradation]
        CIRCUIT[Circuit Breaker]
    end
    
    subgraph "Recovery Actions"
        AUTO_RECOVER[Automatic Recovery]
        USER_ACTION[User Intervention]
        ROLLBACK[State Rollback]
        CLEANUP[Resource Cleanup]
    end
    
    subgraph "User Feedback"
        TOAST[Toast Notifications]
        MODAL_ERR[Error Modals]
        STATUS_IND[Status Indicators]
        LOG_VIEW[Error Log View]
    end
    
    subgraph "Logging & Monitoring"
        ERROR_LOG[Error Logger]
        METRICS[Error Metrics]
        ALERT[Alert System]
        DEBUG[Debug Info]
    end
    
    %% Error flow
    USER --> VALIDATE
    FILE --> CHECK
    NET --> TIMEOUT
    API --> MONITOR
    SYS --> MONITOR
    
    VALIDATE --> BUSINESS
    CHECK --> RECOVERABLE
    TIMEOUT --> RETRYABLE
    MONITOR --> FATAL
    
    BUSINESS --> USER_ACTION
    RECOVERABLE --> AUTO_RECOVER
    RETRYABLE --> RETRY_STRATEGY
    FATAL --> GRACEFUL
    
    RETRY_STRATEGY --> AUTO_RECOVER
    RETRY_STRATEGY --> CIRCUIT
    FALLBACK --> AUTO_RECOVER
    GRACEFUL --> CLEANUP
    CIRCUIT --> FALLBACK
    
    AUTO_RECOVER --> STATUS_IND
    USER_ACTION --> MODAL_ERR
    ROLLBACK --> TOAST
    CLEANUP --> LOG_VIEW
    
    %% Logging all errors
    BUSINESS --> ERROR_LOG
    RECOVERABLE --> ERROR_LOG
    RETRYABLE --> ERROR_LOG
    FATAL --> ERROR_LOG
    
    ERROR_LOG --> METRICS
    METRICS --> ALERT
    ERROR_LOG --> DEBUG
    
    %% Error examples
    USER -.->|Invalid file format<br/>Missing API key<br/>Large file size| EX1[Examples]
    NET -.->|Timeout<br/>Connection lost<br/>DNS failure| EX2[Examples]
    API -.->|401 Unauthorized<br/>429 Rate limit<br/>500 Server error| EX3[Examples]
    
    style USER fill:#ffcccc,stroke:#ff0000,stroke-width:2px
    style FILE fill:#ffcccc,stroke:#ff0000,stroke-width:2px
    style NET fill:#ffcccc,stroke:#ff0000,stroke-width:2px
    style API fill:#ffcccc,stroke:#ff0000,stroke-width:2px
    style SYS fill:#ffcccc,stroke:#ff0000,stroke-width:2px
    
    style AUTO_RECOVER fill:#ccffcc,stroke:#00ff00,stroke-width:2px
    style RETRY_STRATEGY fill:#ffffcc,stroke:#ffff00,stroke-width:2px
    style ERROR_LOG fill:#ccccff,stroke:#0000ff,stroke-width:2px